<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>POS Bán Hàng</title>
<style>
    body {
        font-family: monospace;
        margin: 0;
        padding: 0;
        background: #f0f0f0;
    }
    .container {
        max-width: 800px;
        margin: 20px auto;
        padding: 10px;
        background: #fff;
        border-radius: 5px;
    }
    h1 {
        text-align: center;
    }
    .menu {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 20px;
    }
    .menu button {
        flex: 1 0 30%;
        padding: 10px;
        font-size: 16px;
    }
    #cart {
        margin-bottom: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        padding: 5px;
        text-align: left;
        border-bottom: 1px solid #ccc;
    }
    .total {
        font-weight: bold;
        text-align: right;
        margin-top: 10px;
    }
    /* Hóa đơn ở giữa */
    .invoice {
        width: 58mm;
        margin: 20px auto;
        padding: 5px;
        border: 1px solid #000;
        background: #fff;
    }
    .invoice h2, .invoice p {
        margin: 2px 0;
        font-size: 12px;
    }
    button.print-btn {
        display: block;
        margin: 20px auto;
        padding: 10px 20px;
        font-size: 16px;
    }
</style>
</head>
<body>

<div class="container">
    <h1>Quán Ăn ABC</h1>

    <div class="menu">
        <button onclick="addItem('Cơm gà xối mỡ',50000)">Cơm gà xối mỡ - 50.000đ</button>
        <button onclick="addItem('Phở bò',60000)">Phở bò - 60.000đ</button>
        <button onclick="addItem('Trà đá',5000)">Trà đá - 5.000đ</button>
        <button onclick="addItem('Nước ngọt',10000)">Nước ngọt - 10.000đ</button>
    </div>

    <div id="cart">
        <h3>Giỏ hàng</h3>
        <table id="cartTable">
            <thead>
                <tr>
                    <th>Món</th>
                    <th>SL</th>
                    <th>Giá</th>
                </tr>
            </thead>
            <tbody>
                <!-- Items added dynamically -->
            </tbody>
        </table>
        <p class="total">Tổng: <span id="totalPrice">0</span>đ</p>
    </div>

    <button class="print-btn" onclick="printInvoiceInline()">In hóa đơn</button>

    <!-- Hóa đơn div riêng -->
    <div id="invoice" class="invoice">
        <h2>Quán Ăn ABC</h2>
        <p>Bàn: 5</p>
        <p>Ngày: <span id="invoiceDate"></span></p>

        <table id="invoiceTable">
            <thead>
                <tr>
                    <th>Món</th>
                    <th>SL</th>
                    <th>Giá</th>
                </tr>
            </thead>
            <tbody>
                <!-- Items sẽ copy từ giỏ hàng -->
            </tbody>
        </table>
        <p class="total">Tổng: <span id="invoiceTotal"></span>đ</p>
    </div>
</div>

<script>
let cart = [];

function addItem(name, price) {
    let item = cart.find(i => i.name === name);
    if (item) {
        item.qty += 1;
    } else {
        cart.push({name: name, price: price, qty: 1});
    }
    renderCart();
}

function renderCart() {
    const tbody = document.querySelector('#cartTable tbody');
    tbody.innerHTML = '';
    let total = 0;
    cart.forEach(item => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${item.name}</td><td>${item.qty}</td><td>${item.price*item.qty}</td>`;
        tbody.appendChild(row);
        total += item.price * item.qty;
    });
    document.getElementById('totalPrice').textContent = total;
}

// In trực tiếp trên cùng trang, ẩn các phần khác tạm thời
function printInvoiceInline() {
    const invoice = document.getElementById('invoice');
    const otherElements = Array.from(document.body.children).filter(el => el.id !== 'invoice');

    // Cập nhật hóa đơn
    const invoiceTbody = document.querySelector('#invoiceTable tbody');
    invoiceTbody.innerHTML = document.querySelector('#cartTable tbody').innerHTML;
    document.getElementById('invoiceTotal').textContent = document.getElementById('totalPrice').textContent;
    document.getElementById('invoiceDate').textContent = new Date().toLocaleString();

    // Ẩn các phần khác
    otherElements.forEach(el => el.style.display = 'none');

    // In
    window.print();

    // Hiện lại
    otherElements.forEach(el => el.style.display = '');
}
</script>

</body>
</html>
